# TP07 â€“ MongoDB: User Management and Transactions

## 1. User Management and Access Rights

### Create a Read/Write User (Gerant)

```javascript
db.createUser({
  user: "gerant",
  pwd: "gerant123",
  roles: [{ role: "readWrite", db: "banque" }],
});
```

### Connect as Gerant

```bash
mongosh -u gerant -p gerant123 --authenticationDatabase banque
```

---

## 2. Creation of Collections and Initial Data

```javascript
use banque

db.comptes.insertMany([
  { _id: "COMPTE_A", client: "Alice", solde: 1000, devise: "DA" },
  { _id: "COMPTE_B", client: "Bob", solde: 500, devise: "DA" },
  { _id: "COMPTE_C", client: "Charlie", solde: 200, devise: "DA" }
])
```

---

## 3. Money Transfer Operation

### Create Transactions Collection

```javascript
db.createCollection("transactions");
```

### Update Account Balances

```javascript
db.comptes.updateOne({ _id: "COMPTE_A" }, { $inc: { solde: -100 } });

db.comptes.updateOne({ _id: "COMPTE_B" }, { $inc: { solde: 100 } });
```

### Record the Transaction

```javascript
db.transactions.insertOne({
  from: "COMPTE_A",
  to: "COMPTE_B",
  montant: 100,
  devise: "DA",
  date: new Date(),
});
```

### Display Accounts

```javascript
db.comptes.find().pretty();
```

---

## 4. Read-Only User (Auditor)

```javascript
db.createUser({
  user: "auditeur",
  pwd: "audit123",
  roles: [{ role: "read", db: "banque" }],
});
```
